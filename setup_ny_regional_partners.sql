-- ============================================
-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –¥–ª—è –ù—å—é-–ô–æ—Ä–∫–∞
-- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ NY –Ω–∞ 10 —Ä–∞–π–æ–Ω–æ–≤ —Å –æ–¥–Ω–∏–º –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–æ–º –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–∞–π–æ–Ω
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤ SQL Editor –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ Supabase
-- ============================================

-- –°–ø–∏—Å–æ–∫ 10 —Ä–∞–π–æ–Ω–æ–≤ –ù—å—é-–ô–æ—Ä–∫–∞ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:
-- 1. Manhattan Downtown - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ - –ü—Ä–µ–º–∏—É–º-—Ñ–ª–∞–≥–º–∞–Ω
-- 2. Manhattan Midtown - –û—Ñ–∏—Å–Ω—ã–π/—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫ - –≠–∫—Å–ø—Ä–µ—Å—Å-—É—Å–ª—É–≥–∏
-- 3. Manhattan Upper East - –†–æ—Å–∫–æ—à—å –∏ —Å—Ç–∞—Ç—É—Å - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ª—é–∫—Å
-- 4. Manhattan Upper West - –°–µ–º–µ–π–Ω—ã–π, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ª—é–∫—Å - –õ–æ—è–ª—å–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
-- 5. Brooklyn Downtown - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π —Ö–∞–± –ë—Ä—É–∫–ª–∏–Ω–∞ - –û–±—ä–µ–º –∏ –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å
-- 6. Brooklyn North - –ú–æ–ª–æ–¥–µ–∂–Ω—ã–π/–¢—Ä–µ–Ω–¥–æ–≤—ã–π –ø–æ—Ç–æ–∫ - –¶–µ–Ω—Ç—Ä —Ö–∞–π–ø–∞ –∏ SMM
-- 7. Brooklyn South + S.I. - –ú–æ—Å—Ç –í–µ—Ä—Ä–∞–∑–∞–Ω–æ; —Å–µ–º–µ–π–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç - –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å
-- 8. Queens West + Bronx South - –ú–µ—Ç—Ä–æ-–∫–æ—Ä–∏–¥–æ—Ä; –ø—Ä–∏–≥–æ—Ä–æ–¥–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞
-- 9. Queens East - –î–∞–ª—å–Ω–∏–π, —ç—Ç–Ω–∏—á–µ—Å–∫–∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π - –§–æ–∫—É—Å –Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
-- 10. Brooklyn Central - –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–∞–π–æ–Ω (Crown Heights, Flatbush) - –°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –≤—ã—Å–æ–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å

-- –ü—Ä–∏–º–µ—Ä: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∫–∞–∫ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è —Ä–∞–π–æ–Ω–∞
-- –ó–∞–º–µ–Ω–∏—Ç–µ 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê' –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π chat_id –≤–∞—à–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
-- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–π–æ–Ω–∞ –Ω–∞ –Ω—É–∂–Ω—ã–π
-- –ó–∞–º–µ–Ω–∏—Ç–µ 'business_type' –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥ (—Å–º. —Å–ø–∏—Å–æ–∫ –≤–Ω–∏–∑—É —Å–∫—Ä–∏–ø—Ç–∞)
-- 
-- –í–ê–ñ–ù–û: 
-- 1. –í –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä!
-- 2. –í –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–∞ —É—Å–ª—É–≥ (–∫—Ä–æ–º–µ –æ–Ω–ª–∞–π–Ω) –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–∞—Ä—Ç–Ω–µ—Ä!
-- –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –º–µ–∂–¥—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –≤ –æ–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ.

-- –ü—Ä–∏–º–µ—Ä 1: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Manhattan Downtown (–ü—Ä–µ–º–∏—É–º-—Ñ–ª–∞–≥–º–∞–Ω)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Manhattan Downtown',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'nail_care'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Manhattan Downtown –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'nail_care'!

-- –ü—Ä–∏–º–µ—Ä 2: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Manhattan Midtown (–≠–∫—Å–ø—Ä–µ—Å—Å-—É—Å–ª—É–≥–∏)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Manhattan Midtown',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'hair_salon'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Manhattan Midtown –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'hair_salon'!

-- –ü—Ä–∏–º–µ—Ä 3: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Manhattan Upper East (–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ª—é–∫—Å)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Manhattan Upper East',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'facial_aesthetics'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Manhattan Upper East –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'facial_aesthetics'!

-- –ü—Ä–∏–º–µ—Ä 4: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Manhattan Upper West (–õ–æ—è–ª—å–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Manhattan Upper West',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'massage_therapy'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Manhattan Upper West –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'massage_therapy'!

-- –ü—Ä–∏–º–µ—Ä 5: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Brooklyn Downtown (–û–±—ä–µ–º –∏ –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Brooklyn Downtown',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'nail_care'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Brooklyn Downtown –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'nail_care'!

-- –ü—Ä–∏–º–µ—Ä 6: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Brooklyn North (–¶–µ–Ω—Ç—Ä —Ö–∞–π–ø–∞ –∏ SMM)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Brooklyn North',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'brow_design'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Brooklyn North –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'brow_design'!

-- –ü—Ä–∏–º–µ—Ä 7: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Brooklyn South + S.I. (–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Brooklyn South + S.I.',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'lash_services'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Brooklyn South + S.I. –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'lash_services'!

-- –ü—Ä–∏–º–µ—Ä 8: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Queens West + Bronx South (–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Queens West + Bronx South',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'hair_removal'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Queens West + Bronx South –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'hair_removal'!

-- –ü—Ä–∏–º–µ—Ä 9: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Queens East (–§–æ–∫—É—Å –Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Queens East',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'makeup_pmu'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Queens East –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'makeup_pmu'!

-- –ü—Ä–∏–º–µ—Ä 10: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞ –¥–ª—è Brooklyn Central (–°—Ä–µ–¥–Ω–∏–π —á–µ–∫, –≤—ã—Å–æ–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å)
-- UPDATE partners 
-- SET 
--   city = 'New York',
--   district = 'Brooklyn Central',
--   partner_type = 'master',
--   partner_level = 3,
--   business_type = 'body_wellness'  -- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω—ã–π –≤–∏–¥ —É—Å–ª—É–≥
-- WHERE chat_id = 'CHAT_ID_–ü–ê–†–¢–ù–ï–†–ê';
-- 
-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–π–æ–Ω–µ Brooklyn Central –µ—â–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å business_type = 'body_wellness'!

-- ============================================
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –ù—å—é-–ô–æ—Ä–∫–∞
-- ============================================
SELECT 
  chat_id,
  name,
  company_name,
  city,
  district,
  business_type,
  partner_type,
  partner_level,
  CASE 
    WHEN partner_type = 'master' THEN 'üëë –ú–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä'
    WHEN partner_type = 'regional' THEN '‚úÖ –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä'
    WHEN partner_type = 'partner' THEN 'ü§ù –ü–∞—Ä—Ç–Ω–µ—Ä'
    ELSE 'üë§ –û–±—ã—á–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä'
  END as partner_status
FROM partners
WHERE city = 'New York' AND partner_type = 'master'
ORDER BY district, business_type;

-- ============================================
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å –ª–∏ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞
-- ============================================
WITH ny_districts AS (
  SELECT unnest(ARRAY[
    'Manhattan Downtown',
    'Manhattan Midtown',
    'Manhattan Upper East',
    'Manhattan Upper West',
    'Brooklyn Downtown',
    'Brooklyn North',
    'Brooklyn South + S.I.',
    'Queens West + Bronx South',
    'Queens East',
    'Brooklyn Central'
  ]) AS district
)
SELECT 
  d.district,
  CASE 
    WHEN p.chat_id IS NOT NULL THEN '‚úÖ –ï—Å—Ç—å –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä'
    ELSE '‚ùå –ù–µ—Ç –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞'
  END as status,
  p.name as partner_name,
  p.company_name,
  p.business_type,
  p.chat_id
FROM ny_districts d
LEFT JOIN partners p ON p.district = d.district 
  AND p.city = 'New York' 
  AND p.partner_type = 'master'
ORDER BY d.district;

-- ============================================
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ—Ç –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –≤ –æ–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ
-- –í–ê–ñ–ù–û: –î—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã - —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤!
-- ============================================
SELECT 
  district,
  COUNT(*) as master_count,
  STRING_AGG(name, ', ') as master_names,
  STRING_AGG(chat_id::text, ', ') as chat_ids
FROM partners
WHERE city = 'New York' 
  AND partner_type = 'master'
GROUP BY district
HAVING COUNT(*) > 1;

-- –ï—Å–ª–∏ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å —Ä–∞–π–æ–Ω—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏.
-- –≠—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤!

-- ============================================
-- –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ—Ç –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–∞ —É—Å–ª—É–≥ –≤ –æ–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ
-- –í–ê–ñ–ù–û: –í –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–∞ —É—Å–ª—É–≥ (–∫—Ä–æ–º–µ –æ–Ω–ª–∞–π–Ω) –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–∞—Ä—Ç–Ω–µ—Ä!
-- –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –º–µ–∂–¥—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ —É—Å–ª—É–≥ –≤ –æ–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ.
-- ============================================
SELECT 
  city,
  district,
  business_type,
  COUNT(*) as partner_count,
  STRING_AGG(name, ', ') as partner_names,
  STRING_AGG(chat_id::text, ', ') as chat_ids
FROM partners
WHERE city = 'New York' 
  AND district != 'All'
  AND district IS NOT NULL
  AND district != ''
  AND business_type IS NOT NULL
  AND business_type != ''
  -- –ò—Å–∫–ª—é—á–∞–µ–º –æ–Ω–ª–∞–π–Ω-—É—Å–ª—É–≥–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞)
  AND NOT (city = 'Online' OR district = 'All')
GROUP BY city, district, business_type
HAVING COUNT(*) > 1;

-- –ï—Å–ª–∏ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∑–Ω–∞—á–∏—Ç –µ—Å—Ç—å —Ä–∞–π–æ–Ω—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–∞ —É—Å–ª—É–≥.
-- –≠—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤!

-- ============================================
-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ —É—Å–ª—É–≥ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏:
-- ============================================
-- 'nail_care' - –ù–æ–≥—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å (Nail Care) üíÖ
-- 'brow_design' - –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –∏ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –±—Ä–æ–≤–µ–π (Brow Design) üëÅÔ∏è
-- 'hair_salon' - –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏ (Hair Salon Services) üíá‚Äç‚ôÄÔ∏è
-- 'hair_removal' - –î–µ–ø–∏–ª—è—Ü–∏—è (Hair Removal) ‚ö°
-- 'facial_aesthetics' - –ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è (Facial Aesthetics) ‚ú®
-- 'lash_services' - –ù–∞—Ä–∞—â–∏–≤–∞–Ω–∏–µ –∏ –ª–∞–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å–Ω–∏—Ü (Lash Services) üëÄ
-- 'massage_therapy' - –ú–∞—Å—Å–∞–∂ (Massage Therapy) üíÜ‚Äç‚ôÄÔ∏è
-- 'makeup_pmu' - –í–∏–∑–∞–∂ –∏ –ø–µ—Ä–º–∞–Ω–µ–Ω—Ç (Make-up & PMU) üíÑ
-- 'body_wellness' - –¢–µ–ª–µ—Å–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è (Body Wellness) üå∏
-- 'nutrition_coaching' - –ù—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–∏—è –∏ –ø–∏—Ç–∞–Ω–∏–µ (Nutrition Coaching) üçé
-- 'mindfulness_coaching' - –ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (Mindfulness & Coaching) üß†
-- 'image_consulting' - –°—Ç–∏–ª—å (Image Consulting) üëó
