# üë§ –û–ü–ò–°–ê–ù–ò–ï –û–ü–´–¢–ê –ö–û–ù–ï–ß–ù–û–ì–û –ö–õ–ò–ï–ù–¢–ê

**–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π –∏ —á—Ç–æ –æ–Ω –≤–∏–¥–∏—Ç**

---

## üîÑ –ü–û–õ–ù–´–ô –¶–ò–ö–õ –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø –ö–õ–ò–ï–ù–¢–ê

### 1Ô∏è‚É£ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ö–õ–ò–ï–ù–¢–ê

#### –°—Ü–µ–Ω–∞—Ä–∏–π A: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å—Å—ã–ª–∫—É –æ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞:**
   ```
   https://t.me/client_bot?start=partner_123456789
   ```
   –ò–õ–ò
   ```
   https://t.me/client_bot?start=ref_ABC123
   ```

2. **–ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Å—Å—ã–ª–∫—É –≤ Telegram:**
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç (`@client_bot`)
   - –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/start partner_123456789` –∏–ª–∏ `/start ref_ABC123`

3. **–ë–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é:**
   ```python:client_handler.py
   # –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
   referral_match = REFERRAL_PATTERN.match(message.text)  # partner_123456789
   
   # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ referral_source –≤ –ë–î
   referral_source = referral_match.group(1)  # 123456789
   
   # –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ users
   sm.create_client(chat_id, referral_source=referral_source)
   ```

4. **–í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:**
   ```sql
   INSERT INTO users (
     chat_id,
     referral_source,  -- '123456789' (partner_chat_id)
     balance,
     registration_date
   )
   ```

5. **–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:**
   ```
   üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ LoyalityBot!
   
   üéØ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏:
   ‚Ä¢ –ù–∞–∫–∞–ø–ª–∏–≤–∞–π—Ç–µ –±–∞–ª–ª—ã –∑–∞ –∫–∞–∂–¥—É—é –ø–æ–∫—É–ø–∫—É
   ‚Ä¢ –ü–æ–ª—É—á–∞–π—Ç–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏
   ‚Ä¢ –û–±–º–µ–Ω–∏–≤–∞–π—Ç–µ –±–∞–ª–ª—ã –Ω–∞ —É—Å–ª—É–≥–∏
   
   [üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ] [üì± –ü–æ–∫–∞–∑–∞—Ç—å QR-–∫–æ–¥]
   ```

#### –°—Ü–µ–Ω–∞—Ä–∏–π B: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–µ–∑ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏

1. –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç `/start` –≤ –±–æ—Ç–µ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
2. –ë–æ—Ç —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –±–µ–∑ `referral_source`
3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ –∂–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

### 2Ô∏è‚É£ –û–¢–ö–†–´–¢–ò–ï –í–ï–ë-–ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

#### –ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–ë–æ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
   ```python:client_handler.py
   BASE_DOMAIN = os.environ.get('FRONTEND_URL')  # https://frontend.netlify.app
   
   web_app_url = f"{BASE_DOMAIN}?v={cache_bust}&nocache=1&..."
   
   # –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ Web App
   webapp_btn = types.InlineKeyboardButton(
       "üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
       web_app=types.WebAppInfo(url=web_app_url)
   )
   ```

2. **Telegram –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Web App:**
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä Telegram (iframe)
   - URL: `https://frontend.netlify.app`
   - **–ë–ï–ó –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ city –∏–ª–∏ partner_id** –≤ URL

3. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
   - React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `chat_id` –∏–∑ Telegram Web App:
   ```javascript
   const chatId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id
   ```

---

### 3Ô∏è‚É£ –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ö–û–ù–¢–ï–ö–°–¢–ê –ù–ê –§–†–û–ù–¢–ï–ù–î–ï

#### –ö–∞–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É?

**–í–∞–∂–Ω–æ:** –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ù–ï –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–æ—Ä–æ–¥–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∏–∑ URL –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º.

#### –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞

```javascript:frontend/src/services/supabase.js
// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç referral_source –∫–ª–∏–µ–Ω—Ç–∞
export const getReferralPartnerInfo = async (clientChatId) => {
  // 1. –ü–æ–ª—É—á–∞–µ–º referral_source –∏–∑ —Ç–∞–±–ª–∏—Ü—ã users
  const { data: user } = await supabase
    .from('users')
    .select('referral_source')
    .eq('chat_id', clientChatId)
    .single()
  
  // 2. –ï—Å–ª–∏ –µ—Å—Ç—å referral_source, –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Ç–Ω–µ—Ä–µ
  if (user?.referral_source) {
    const partnerChatId = user.referral_source
    
    // 3. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
    const { data: partner } = await supabase
      .from('partners')
      .select('business_type, chat_id, city')
      .eq('chat_id', partnerChatId)
      .single()
    
    return {
      chatId: partner.chat_id,
      businessType: partner.business_type,
      city: partner.city  // ‚úÖ –ì–æ—Ä–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞!
    }
  }
  
  return null
}
```

#### –®–∞–≥ 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—Å–ª—É–≥ –ø–æ –≥–æ—Ä–æ–¥—É

```javascript:frontend/src/pages/Services.jsx
const loadData = async () => {
  // 1. –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Ç–Ω–µ—Ä–µ (–≤–∫–ª—é—á–∞—è city)
  const partnerInfo = await getReferralPartnerInfo(chatId)
  // partnerInfo.city = "Nha Trang" –∏–ª–∏ "New York" –∏–ª–∏ null
  
  // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Å–ª—É–≥–∏ (–ë–ï–ó —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ä–æ–¥—É –≤ URL)
  const servicesData = await getFilteredServices(null, null)
  // getFilteredServices –ø–æ–ª—É—á–∞–µ—Ç –í–°–ï —É—Å–ª—É–≥–∏ –∏–∑ –ë–î
  
  // 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ:
  // - –ï—Å–ª–∏ –µ—Å—Ç—å cityParam –≤ URL - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω
  // - –ï—Å–ª–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —É—Å–ª—É–≥–∏
  // - –ü–∞—Ä—Ç–Ω–µ—Ä –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö (work_mode: 'online', 'hybrid')
}
```

#### –®–∞–≥ 3: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –í–∞–ª—é—Ç—É –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–≥–æ—Ä–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞**, –ù–ï –≥–æ—Ä–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞!

```javascript:frontend/src/pages/PartnerAnalytics.jsx
// –ö–æ–≥–¥–∞ –ø–∞—Ä—Ç–Ω–µ—Ä —Å–º–æ—Ç—Ä–∏—Ç —Å–≤–æ—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
const partnerInfo = await getPartnerInfo(partnerId)  // –ü–æ–ª—É—á–∞–µ–º partner.city
const partnerCity = partnerInfo.city  // "Nha Trang"

// –ü—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ü–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ä–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:
formatCurrencySimple(amount, partnerCity)  // ‚Üí "500.000‚Ç´" –µ—Å–ª–∏ city = "Nha Trang"
```

**–ù–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:**

```javascript:frontend/src/pages/Services.jsx
// –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —É—Å–ª—É–≥–∏ –æ—Ç –†–ê–ó–ù–´–• –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
services.forEach(service => {
  const partnerCity = service.partner?.city  // –ì–æ—Ä–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
  
  // –ö–∞–∂–¥–∞—è —É—Å–ª—É–≥–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –≤–∞–ª—é—Ç–µ –°–í–û–ï–ì–û –ø–∞—Ä—Ç–Ω–µ—Ä–∞
  formatCurrency(service.price_points, partnerCity)
})
```

---

### 4Ô∏è‚É£ –ß–¢–û –í–ò–î–ò–¢ –ö–õ–ò–ï–ù–¢

#### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (Home.jsx)

**–ß—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**

1. **–ë–∞–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç–∞:**
   ```javascript
   const balance = await getClientBalance(chatId)
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –±–∞–ª–ª–∞—Ö (–Ω–µ –≤ –≤–∞–ª—é—Ç–µ)
   ```

2. **–ê–∫—Ü–∏–∏ (Promotions):**
   ```javascript
   const promotions = await getActivePromotions()
   // –í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∞–∫—Ü–∏–∏ –æ—Ç –≤—Å–µ—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
   ```

3. **–£—Å–ª—É–≥–∏:**
   ```javascript
   const services = await getApprovedServices()
   // –í–°–ï —É—Å–ª—É–≥–∏ –æ—Ç –≤—Å–µ—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
   // –§–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –ø–∞—Ä—Ç–Ω–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≥–ª–∞—Å–∏–ª –∫–ª–∏–µ–Ω—Ç–∞
   ```

4. **–ù–æ–≤–æ—Å—Ç–∏:**
   ```javascript
   const news = await getPublishedNews()
   // –í—Å–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏
   ```

**–í–∞–ª—é—Ç–∞:** –ù–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (—Ü–µ–Ω—ã –≤ –±–∞–ª–ª–∞—Ö)

---

#### –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ª—É–≥ (Services.jsx)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï —É—Å–ª—É–≥–∏:**
   ```javascript
   const servicesData = await getFilteredServices(cityParam || null, null)
   ```

2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ—Ä–æ–¥—É (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω):**
   ```javascript:frontend/src/services/supabase.js
   // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å—Ç–æ—Ä–æ–Ω–µ
   if (city) {
     filteredData = filteredData.filter(service => 
       service.partner?.city === city || 
       service.partner?.work_mode === 'online' ||
       service.partner?.city === '–í—Å–µ'
     )
   }
   ```

3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ª—É–≥:**
   - –ö–∞–∂–¥–∞—è —É—Å–ª—É–≥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—É **–≤ –±–∞–ª–ª–∞—Ö**
   - –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –ø–æ –≥–æ—Ä–æ–¥—É –≤—Ä—É—á–Ω—É—é
   - **–í–∞–ª—é—Ç–∞ –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è** –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É—Å–ª—É–≥

**–ü—Ä–∏–º–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
```
üíÖ –ú–∞–Ω–∏–∫—é—Ä
–¶–µ–Ω–∞: 500 –±–∞–ª–ª–æ–≤
üìç –ü–∞—Ä—Ç–Ω–µ—Ä: MBAR (–ù—è—á–∞–Ω–≥)
```

---

### 5Ô∏è‚É£ –û–¢–ö–£–î–ê –ë–ï–†–ï–¢–°–Ø –í–ê–õ–Æ–¢–ê?

#### –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤–∞–ª—é—Ç–∞ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —è–≤–Ω–æ!

**–ü–æ—á–µ–º—É:**

1. **–ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ü–µ–Ω—ã –≤ –±–∞–ª–ª–∞—Ö:**
   - "500 –±–∞–ª–ª–æ–≤"
   - "1000 –±–∞–ª–ª–æ–≤"
   - –ù–µ "500.000‚Ç´" –∏–ª–∏ "$20"

2. **–ü–∞—Ä—Ç–Ω–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å:**
   - –ü–∞—Ä—Ç–Ω–µ—Ä –∏–∑ –ù—è—á–∞–Ω–≥–∞: 1 –±–∞–ª–ª = 5.000‚Ç´ (–ø—Ä–∏–º–µ—Ä–Ω–æ)
   - –ü–∞—Ä—Ç–Ω–µ—Ä –∏–∑ –ù—å—é-–ô–æ—Ä–∫–∞: 1 –±–∞–ª–ª = $0.20 (–ø—Ä–∏–º–µ—Ä–Ω–æ)
   - **–ù–æ –∫–ª–∏–µ–Ω—Ç —ç—Ç–æ–≥–æ –Ω–µ –≤–∏–¥–∏—Ç!**

3. **–í–∞–ª—é—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏:**
   - –í –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ
   - –ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –±–∞–ª–ª–æ–≤
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É—Å–ª—É–≥

---

### 6Ô∏è‚É£ –ü–†–ò–ú–ï–†–´ –°–¶–ï–ù–ê–†–ò–ï–í

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–ª–∏–µ–Ω—Ç –∏–∑ –ù—è—á–∞–Ω–≥–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∏–∑ –ù—è—á–∞–Ω–≥–∞

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
   ```
   /start partner_987654321  (partner.city = "Nha Trang")
   ```

2. **–í –ë–î:**
   ```sql
   users.referral_source = '987654321'
   ```

3. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç:**
   - `getReferralPartnerInfo()` ‚Üí `{ city: "Nha Trang" }`
   - –£—Å–ª—É–≥–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - **–ù–æ —Ü–µ–Ω—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –≤ –±–∞–ª–ª–∞—Ö!**

4. **–ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç:**
   ```
   üíÖ –ú–∞–Ω–∏–∫—é—Ä - 500 –±–∞–ª–ª–æ–≤
   üç£ –°–µ—Ç —Å—É—à–∏ - 1000 –±–∞–ª–ª–æ–≤
   ```

---

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–ª–∏–µ–Ω—Ç –∏–∑ –ù—è—á–∞–Ω–≥–∞, –Ω–æ —Å–º–æ—Ç—Ä–∏—Ç —É—Å–ª—É–≥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏–∑ –ù—å—é-–ô–æ—Ä–∫–∞

1. **–ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä:** "New York"

2. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç:**
   ```javascript
   const filtered = services.filter(s => 
     s.partner?.city === "New York" || 
     s.partner?.work_mode === "online"
   )
   ```

3. **–ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç:**
   ```
   üíÜ‚Äç‚ôÄÔ∏è –ú–∞—Å—Å–∞–∂ - 800 –±–∞–ª–ª–æ–≤  (–ø–∞—Ä—Ç–Ω–µ—Ä –∏–∑ NY)
   üçï –ü–∏—Ü—Ü–∞ - 600 –±–∞–ª–ª–æ–≤    (–ø–∞—Ä—Ç–Ω–µ—Ä –∏–∑ NY)
   ```

4. **–í–∞–ª—é—Ç–∞:** –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (–≤—Å–µ –≤ –±–∞–ª–ª–∞—Ö)

---

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–∞—Ä—Ç–Ω–µ—Ä –∏–∑ –ù—è—á–∞–Ω–≥–∞ —Å–º–æ—Ç—Ä–∏—Ç —Å–≤–æ—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É

1. **–ü–∞—Ä—Ç–Ω–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –±–æ—Ç**
2. **–ù–∞–∂–∏–º–∞–µ—Ç "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"**
3. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:** `https://frontend.netlify.app?partner_id=987654321`

4. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç:**
   ```javascript
   const partnerInfo = await getPartnerInfo(partnerId)
   const partnerCity = partnerInfo.city  // "Nha Trang"
   ```

5. **–û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å—É–º–º—ã –≤ VND:**
   ```
   –û–±—â–∏–π –æ–±–æ—Ä–æ—Ç: 50.000.000‚Ç´
   –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 500.000‚Ç´
   –ö—ç—à–±—ç–∫: 2.500.000‚Ç´
   ```

---

### 7Ô∏è‚É£ –†–ï–ó–Æ–ú–ï: –ö–ê–ö –°–ò–°–¢–ï–ú–ê –ü–û–ù–ò–ú–ê–ï–¢, –ß–¢–û –ü–û–ö–ê–ó–´–í–ê–¢–¨

#### –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** `referral_source` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `users.referral_source`
2. **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** URL –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, `chat_id` –∏–∑ Telegram Web App
3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:** `getReferralPartnerInfo(chatId)` ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `partner.city`
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—Å–ª—É–≥:** –ü–æ `city` –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∏–ª–∏ –ø–æ `partner.city`
5. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω:** –í—Å–µ–≥–¥–∞ –≤ –±–∞–ª–ª–∞—Ö (–Ω–µ –≤ –≤–∞–ª—é—Ç–µ)

#### –î–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞:

1. **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** URL —Å `?partner_id=...`
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã:** `getPartnerInfo(partnerId)` ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `partner.city`
3. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** `formatCurrency(value, partner.city)` ‚Üí "500.000‚Ç´" –∏–ª–∏ "$500"

---

### 8Ô∏è‚É£ –ö–õ–Æ–ß–ï–í–´–ï –†–ê–ó–õ–ò–ß–ò–Ø

| –ê—Å–ø–µ–∫—Ç | –ö–ª–∏–µ–Ω—Ç | –ü–∞—Ä—Ç–Ω–µ—Ä |
|--------|--------|---------|
| **–í–∞–ª—é—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ** | ‚ùå –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è | ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (VND, USD, etc.) |
| **–¶–µ–Ω—ã** | –í –±–∞–ª–ª–∞—Ö (500, 1000) | –í –≤–∞–ª—é—Ç–µ (500.000‚Ç´, $20) |
| **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞** | –ò–∑ `referral_source` ‚Üí `partner.city` | –ò–∑ `partner.city` –Ω–∞–ø—Ä—è–º—É—é |
| **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—Å–ª—É–≥** | –ü–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≥–æ—Ä–æ–¥—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –ü–æ —Å–≤–æ–µ–º—É –≥–æ—Ä–æ–¥—É (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) |
| **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** | –ë–∞–ª–∞–Ω—Å, –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | –û–±–æ—Ä–æ—Ç, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, –∫—ç—à–±—ç–∫ –≤ –≤–∞–ª—é—Ç–µ |

---

## ‚ùì –ß–ê–°–¢–û –ó–ê–î–ê–í–ê–ï–ú–´–ï –í–û–ü–†–û–°–´

### Q: –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç —Ä–∞–∑–Ω—ã–µ –≤–∞–ª—é—Ç—ã –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ?

**A:** –ù–µ—Ç. –ö–ª–∏–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏—Ç —Ü–µ–Ω—ã –≤ –±–∞–ª–ª–∞—Ö. –í–∞–ª—é—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ä–∞—Å—á–µ—Ç–æ–≤.

### Q: –ö–∞–∫ –∫–ª–∏–µ–Ω—Ç –∏–∑ –ù—è—á–∞–Ω–≥–∞ –≤–∏–¥–∏—Ç —É—Å–ª—É–≥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∏–∑ –ù—è—á–∞–Ω–≥–∞?

**A:** 
1. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∏–∑ –ù—è—á–∞–Ω–≥–∞ ‚Üí —É—Å–ª—É–≥–∏ —ç—Ç–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
2. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä "–ù—è—á–∞–Ω–≥" –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–µ –ª–æ–∫–∞—Ü–∏–∏
3. –£—Å–ª—É–≥–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ `partner.city === "Nha Trang"`

### Q: –û—Ç–∫—É–¥–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–Ω–∞–µ—Ç, –∫–∞–∫–æ–π –≥–æ—Ä–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–µ?

**A:** 
- –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ `frontend/src/utils/locations.js`
- –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π –≥–æ—Ä–æ–¥
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –≥–æ—Ä–æ–¥–∞ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —É—Å–ª—É–≥–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏–∑ —ç—Ç–æ–≥–æ –≥–æ—Ä–æ–¥–∞

### Q: –ß—Ç–æ –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–Ω–ª–∞–π–Ω (work_mode = 'online')?

**A:** 
- –ü–∞—Ä—Ç–Ω–µ—Ä—ã —Å `work_mode = 'online'` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –í–°–ï–ú –∫–ª–∏–µ–Ω—Ç–∞–º
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- –ò—Ö –≥–æ—Ä–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å "Online" –∏–ª–∏ "–í—Å–µ" ‚Üí –≤–∞–ª—é—Ç–∞ USD –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

---

**–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω:** –î–µ–∫–∞–±—Ä—å 2025  
**–í–µ—Ä—Å–∏—è:** 1.0
