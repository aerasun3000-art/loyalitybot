# üöÄ –ü–ª–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è LoyalityBot

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2 —è–Ω–≤–∞—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 0.8.1  
**–¶–µ–ª—å:** –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ 10,000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ–∫—É—â–∏–π –ª–∏–º–∏—Ç | –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ |
|-----------|---------------|-------------------|
| **Telegram Bot** | ~30 req/s –Ω–∞ –±–æ—Ç | –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ (horizontal scaling) |
| **Supabase Free** | 500MB DB | Paid plan (–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ) |
| **Vercel Free** | 100GB bandwidth | Paid plan |
| **GigaChat API** | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞ | Paid plan |

### –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

```
üë• –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
‚îú‚îÄ‚îÄ 0-1,000 —é–∑–µ—Ä–æ–≤:      ‚úÖ –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îú‚îÄ‚îÄ 1,000-10,000:        ‚úÖ Upgrade Supabase plan
‚îú‚îÄ‚îÄ 10,000-100,000:      ‚ö†Ô∏è –ù—É–∂–µ–Ω Redis, Load Balancer
‚îú‚îÄ‚îÄ 100,000-1,000,000:   ‚ö†Ô∏è Kubernetes, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
‚îî‚îÄ‚îÄ 1,000,000+:          ‚ö†Ô∏è –ü–æ–ª–Ω–∞—è —Ä–µ–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```

### –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

- ‚ö†Ô∏è **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏:** `USER_STATE = {}`, `TEMP_DATA = {}` - —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚ö†Ô∏è **–ù–µ—Ç connection pooling:** –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤:** –ù–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö (phone, referral_source, date_time)
- ‚ö†Ô∏è **–ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:** –ë–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ limit/offset
- ‚ö†Ô∏è **–ù–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞

---

## üéØ –≠—Ç–∞–ø 1: –ë—ã—Å—Ç—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

### 1.1 –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Redis (–ö–†–ò–¢–ò–ß–ù–û) üî¥

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π.

#### –®–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redis:**
   ```bash
   # –í–∞—Ä–∏–∞–Ω—Ç 1: Docker (–ª–æ–∫–∞–ª—å–Ω–æ)
   docker-compose up -d redis
   
   # –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±–ª–∞–∫–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   # - Upstash Redis: $10-50/–º–µ—Å
   # - Fly.io Redis: –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π
   # - AWS ElastiCache: $15-100/–º–µ—Å
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   pip install redis
   ```

3. **–°–æ–∑–¥–∞–Ω–∏–µ Redis Manager:**
   ```python
   # redis_manager.py
   import redis
   import json
   import os
   from typing import Optional, Dict, Any
   
   class RedisManager:
       def __init__(self):
           redis_url = os.getenv('REDIS_URL', 'redis://localhost:6379/0')
           self.client = redis.from_url(redis_url, decode_responses=True)
       
       def set_user_state(self, user_id: str, state: str, data: Optional[Dict] = None):
           key = f"user_state:{user_id}"
           value = {'state': state, 'data': data or {}}
           self.client.setex(key, 3600, json.dumps(value))  # TTL 1 —á–∞—Å
       
       def get_user_state(self, user_id: str) -> Optional[Dict]:
           key = f"user_state:{user_id}"
           value = self.client.get(key)
           return json.loads(value) if value else None
       
       def set_temp_data(self, user_id: str, key: str, value: Any, ttl: int = 300):
           redis_key = f"temp_data:{user_id}:{key}"
           self.client.setex(redis_key, ttl, json.dumps(value))
       
       def get_temp_data(self, user_id: str, key: str) -> Optional[Any]:
           redis_key = f"temp_data:{user_id}:{key}"
           value = self.client.get(redis_key)
           return json.loads(value) if value else None
   ```

4. **–ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–¥–∞:**
   - –ó–∞–º–µ–Ω–∏—Ç—å `USER_STATE[user_id]` –Ω–∞ `redis_manager.get_user_state(user_id)`
   - –ó–∞–º–µ–Ω–∏—Ç—å `TEMP_DATA[user_id]` –Ω–∞ `redis_manager.get_temp_data(user_id)`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –±–æ—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (TTL)

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $10-50/–º–µ—Å

---

### 1.2 –ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–æ–ª—è.

#### SQL –º–∏–≥—Ä–∞—Ü–∏—è:

```sql
-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã users
CREATE INDEX IF NOT EXISTS idx_users_phone ON users(phone);
CREATE INDEX IF NOT EXISTS idx_users_referral_source ON users(referral_source);
CREATE INDEX IF NOT EXISTS idx_users_chat_id ON users(chat_id);
CREATE INDEX IF NOT EXISTS idx_users_city ON users(city);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã transactions
CREATE INDEX IF NOT EXISTS idx_transactions_date_time ON transactions(date_time);
CREATE INDEX IF NOT EXISTS idx_transactions_client_chat_id ON transactions(client_chat_id);
CREATE INDEX IF NOT EXISTS idx_transactions_partner_chat_id ON transactions(partner_chat_id);
CREATE INDEX IF NOT EXISTS idx_transactions_status ON transactions(status);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã partners
CREATE INDEX IF NOT EXISTS idx_partners_chat_id ON partners(chat_id);
CREATE INDEX IF NOT EXISTS idx_partners_is_approved ON partners(is_approved);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã promotions
CREATE INDEX IF NOT EXISTS idx_promotions_partner_chat_id ON promotions(partner_chat_id);
CREATE INDEX IF NOT EXISTS idx_promotions_is_published ON promotions(is_published);
CREATE INDEX IF NOT EXISTS idx_promotions_created_at ON promotions(created_at);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã services
CREATE INDEX IF NOT EXISTS idx_services_partner_chat_id ON services(partner_chat_id);
CREATE INDEX IF NOT EXISTS idx_services_is_published ON services(is_published);
CREATE INDEX IF NOT EXISTS idx_services_category_id ON services(category_id);
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 10-100 —Ä–∞–∑
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î

**–í—Ä–µ–º—è:** 1 –¥–µ–Ω—å  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0 (–µ—Å–ª–∏ –Ω–∞ Free –ø–ª–∞–Ω–µ Supabase)

---

### 1.3 –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤–æ –≤—Å–µ endpoints —Å–æ —Å–ø–∏—Å–∫–∞–º–∏.

#### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

```python
# supabase_manager.py
def get_transactions(self, client_chat_id: int, limit: int = 50, offset: int = 0):
    """–ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π"""
    response = (
        self.client
        .from_('transactions')
        .select('*')
        .eq('client_chat_id', client_chat_id)
        .order('date_time', desc=True)
        .range(offset, offset + limit - 1)
        .execute()
    )
    return response.data

def get_promotions(self, city: str = None, limit: int = 20, offset: int = 0):
    """–ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ü–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π"""
    query = (
        self.client
        .from_('promotions')
        .select('*')
        .eq('is_published', True)
        .order('created_at', desc=True)
        .range(offset, offset + limit - 1)
    )
    
    if city:
        query = query.eq('city', city)
    
    response = query.execute()
    return response.data
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–æ–≤
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î –∏ —Å–µ—Ç—å

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0

---

### 1.4 Connection Pooling

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î.

**–†–µ—à–µ–Ω–∏–µ:** Supabase SDK —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç connection pooling, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

#### –ü—Ä–æ–≤–µ—Ä–∫–∞:

```python
# supabase_manager.py
from supabase import create_client, Client

class SupabaseManager:
    def __init__(self):
        # Supabase SDK –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç connection pooling
        # –ù–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
        self.client: Client = create_client(
            supabase_url=os.getenv('SUPABASE_URL'),
            supabase_key=os.getenv('SUPABASE_KEY'),
            options={
                'db': {
                    'schema': 'public',
                },
                'global': {
                    'headers': {
                        'x-client-info': 'loyalitybot/0.8.1'
                    }
                }
            }
        )
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–µ–∫

**–í—Ä–µ–º—è:** 1 –¥–µ–Ω—å (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0

---

## üéØ –≠—Ç–∞–ø 2: –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ (2-4 –Ω–µ–¥–µ–ª–∏)

### 2.1 –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞.

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose (–¥–ª—è –Ω–∞—á–∞–ª–∞)

```yaml
# docker-compose.scale.yml
version: '3.8'

services:
  # –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–π –±–æ—Ç - –∏–Ω—Å—Ç–∞–Ω—Å 1
  partner-bot-1:
    build: .
    container_name: loyalitybot-partner-1
    restart: unless-stopped
    env_file:
      - .env
    command: python bot.py
    depends_on:
      - redis
    networks:
      - loyalitybot-network

  # –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–π –±–æ—Ç - –∏–Ω—Å—Ç–∞–Ω—Å 2
  partner-bot-2:
    build: .
    container_name: loyalitybot-partner-2
    restart: unless-stopped
    env_file:
      - .env
    command: python bot.py
    depends_on:
      - redis
    networks:
      - loyalitybot-network

  # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è client-bot –∏ admin-bot
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: Kubernetes (–¥–ª—è production)

```yaml
# k8s/partner-bot-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: partner-bot
spec:
  replicas: 3  # 3 –∏–Ω—Å—Ç–∞–Ω—Å–∞
  selector:
    matchLabels:
      app: partner-bot
  template:
    metadata:
      labels:
        app: partner-bot
    spec:
      containers:
      - name: partner-bot
        image: loyalitybot:latest
        env:
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: redis-secret
              key: url
        resources:
          requests:
            memory: "256Mi"
            cpu: "100m"
          limits:
            memory: "512Mi"
            cpu: "500m"
---
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: partner-bot-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: partner-bot
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ N —Ä–∞–∑ (N = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤)
- ‚úÖ –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (–µ—Å–ª–∏ –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å —É–ø–∞–ª, –¥—Ä—É–≥–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç)

**–í—Ä–µ–º—è:** 3-5 –¥–Ω–µ–π  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $20-100/–º–µ—Å (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã)

---

### 2.2 Load Balancer

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ –±–æ—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Nginx –∏–ª–∏ Traefik –∫–∞–∫ load balancer.

#### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```nginx
# nginx.conf
upstream partner_bot {
    least_conn;  # –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞–∏–º–µ–Ω—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    server partner-bot-1:8000;
    server partner-bot-2:8000;
    server partner-bot-3:8000;
}

server {
    listen 80;
    server_name api.loyalitybot.com;

    location / {
        proxy_pass http://partner_bot;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # Health checks
        proxy_connect_timeout 5s;
        proxy_send_timeout 5s;
        proxy_read_timeout 5s;
    }

    # Health check endpoint
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —É–ø–∞–≤—à–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $10-50/–º–µ—Å

---

### 2.3 Message Queue –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ–ª–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Queue (RQ) –∏–ª–∏ Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á.

#### –ü—Ä–∏–º–µ—Ä —Å RQ:

```python
# tasks.py
from redis import Redis
from rq import Queue
import os

redis_conn = Redis.from_url(os.getenv('REDIS_URL'))
task_queue = Queue('default', connection=redis_conn)

@task_queue.job
def send_notification(chat_id: int, message: str):
    """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"""
    # –õ–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
    pass

@task_queue.job
def generate_report(partner_id: int):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –≤ —Ñ–æ–Ω–µ"""
    # –õ–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
task_queue.enqueue(send_notification, chat_id=123, message="Hello")
```

**–ó–∞–¥–∞—á–∏ –¥–ª—è –æ—á–µ—Ä–µ–¥–∏:**
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- MLM —Ä–∞—Å—á–µ—Ç—ã
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á

**–í—Ä–µ–º—è:** 3-5 –¥–Ω–µ–π  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0 (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ Redis)

---

### 2.4 –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π Rate Limiting

**–ü—Ä–æ–±–ª–µ–º–∞:** Rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ rate limiting.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```python
# redis_rate_limiter.py
import redis
import time
from typing import Tuple, Optional

class RedisRateLimiter:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def check_rate_limit(self, user_id: str, action: str, 
                        max_requests: int, window_seconds: int) -> Tuple[bool, Optional[str]]:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit —á–µ—Ä–µ–∑ Redis"""
        key = f"rate_limit:{user_id}:{action}"
        current = self.redis.incr(key)
        
        if current == 1:
            # –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º TTL
            self.redis.expire(key, window_seconds)
        
        if current > max_requests:
            ttl = self.redis.ttl(key)
            return False, f"–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç. –ü–æ–¥–æ–∂–¥–∏—Ç–µ {ttl} —Å–µ–∫."
        
        return True, None
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ Rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ —Å–ø–∞–º–∞

**–í—Ä–µ–º—è:** 1-2 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0 (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ Redis)

---

### 2.5 CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤.

#### –í–∞—Ä–∏–∞–Ω—Ç—ã:

1. **Cloudflare** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ):
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å –¥–æ–º–µ–Ω –∫ Cloudflare
   - –í–∫–ª—é—á–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏

2. **Supabase Storage + CDN:**
   - Supabase Storage —É–∂–µ –∏–º–µ–µ—Ç CDN
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

3. **AWS CloudFront:**
   - –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
   - $0.085/GB

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í—Ä–µ–º—è:** 1-2 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $0-20/–º–µ—Å

---

## üéØ –≠—Ç–∞–ø 3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-3 –º–µ—Å—è—Ü–∞)

### 3.1 Read Replicas –¥–ª—è –ë–î

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞–≥—Ä—É–∂–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ë–î.

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å read replicas –¥–ª—è —á—Ç–µ–Ω–∏—è.

#### Supabase Read Replicas:

```python
# supabase_manager.py
class SupabaseManager:
    def __init__(self):
        # –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
        self.client = create_client(
            supabase_url=os.getenv('SUPABASE_URL'),
            supabase_key=os.getenv('SUPABASE_KEY')
        )
        
        # Read replica –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
        self.read_client = create_client(
            supabase_url=os.getenv('SUPABASE_READ_REPLICA_URL'),
            supabase_key=os.getenv('SUPABASE_KEY')
        )
    
    def get_analytics(self):
        """–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å read replica –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"""
        return self.read_client.from_('transactions').select('*').execute()
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –ë–î
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã

**–í—Ä–µ–º—è:** 3-5 –¥–Ω–µ–π  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $25-100/–º–µ—Å (Supabase Pro)

---

### 3.2 Kubernetes –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å–ª–æ–∂–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kubernetes –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Deployments** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
2. **Services** - –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
3. **HorizontalPodAutoscaler** - –¥–ª—è –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥–∞
4. **ConfigMaps** - –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
5. **Secrets** - –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–í—Ä–µ–º—è:** 1-2 –Ω–µ–¥–µ–ª–∏  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $100-500/–º–µ—Å (Kubernetes –∫–ª–∞—Å—Ç–µ—Ä)

---

### 3.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus + Grafana.

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Prometheus** - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
2. **Grafana** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
3. **Alertmanager** - –∞–ª–µ—Ä—Ç—ã –≤ Telegram

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
- CPU –∏ –ø–∞–º—è—Ç—å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –û—à–∏–±–∫–∏
- –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–í—Ä–µ–º—è:** 1 –Ω–µ–¥–µ–ª—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $20-100/–º–µ—Å (–∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö)

---

### 3.4 Sharding –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∏–∑-–∑–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** Sharding –ë–î –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º.

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

```
–†–µ–≥–∏–æ–Ω 1 (–ï–≤—Ä–æ–ø–∞):
‚îú‚îÄ‚îÄ –ë–î: Supabase EU
‚îú‚îÄ‚îÄ –ë–æ—Ç—ã: Fly.io EU
‚îî‚îÄ‚îÄ CDN: Cloudflare EU

–†–µ–≥–∏–æ–Ω 2 (–ê–∑–∏—è):
‚îú‚îÄ‚îÄ –ë–î: Supabase Asia
‚îú‚îÄ‚îÄ –ë–æ—Ç—ã: Fly.io Asia
‚îî‚îÄ‚îÄ CDN: Cloudflare Asia
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–∏–∑–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ –∫–∞–∂–¥–æ–º —Ä–µ–≥–∏–æ–Ω–µ
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å

**–í—Ä–µ–º—è:** 2-4 –Ω–µ–¥–µ–ª–∏  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** $200-1000/–º–µ—Å (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã)

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —ç—Ç–∞–ø–∞–º

| –≠—Ç–∞–ø | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | –ó–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ |
|------|--------------|--------------|--------------|
| **–¢–µ–∫—É—â–µ–µ** | 0-1,000 | ~30 req/s –Ω–∞ –±–æ—Ç | 200-500ms |
| **–ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 1** | 1,000-10,000 | ~100 req/s —Å—É–º–º–∞—Ä–Ω–æ | 100-300ms |
| **–ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 2** | 10,000-100,000 | ~500+ req/s —Å—É–º–º–∞—Ä–Ω–æ | 50-150ms |
| **–ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 3** | 100,000+ | –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ | 20-100ms |

### –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

| –≠—Ç–∞–ø | –ú–µ—Å—è—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å | –ì–æ–¥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å |
|------|-------------------|-------------------|
| **–¢–µ–∫—É—â–µ–µ (Free)** | $0-5 | $0-60 |
| **–≠—Ç–∞–ø 1** | $10-50 | $120-600 |
| **–≠—Ç–∞–ø 2** | $50-200 | $600-2,400 |
| **–≠—Ç–∞–ø 3** | $200-1,000 | $2,400-12,000 |

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ù–µ–¥–µ–ª—è 1-2: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] **–î–µ–Ω—å 1-2:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis (Upstash –∏–ª–∏ Fly.io)
- [ ] **–î–µ–Ω—å 3-5:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å USER_STATE –Ω–∞ Redis
- [ ] **–î–µ–Ω—å 6-7:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å TEMP_DATA –Ω–∞ Redis
- [ ] **–î–µ–Ω—å 8-9:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
- [ ] **–î–µ–Ω—å 10-12:** –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤–æ –≤—Å–µ endpoints
- [ ] **–î–µ–Ω—å 13-14:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –ù–µ–¥–µ–ª—è 3-4: –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫

- [ ] **–î–µ–Ω—å 15-17:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Message Queue (RQ)
- [ ] **–î–µ–Ω—å 18-19:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting —á–µ—Ä–µ–∑ Redis
- [ ] **–î–µ–Ω—å 20-21:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å 2-3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞
- [ ] **–î–µ–Ω—å 22-24:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Load Balancer (Nginx)
- [ ] **–î–µ–Ω—å 25-28:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

### –ú–µ—Å—è—Ü 2-3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] **–ù–µ–¥–µ–ª—è 5-6:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus/Grafana)
- [ ] **–ù–µ–¥–µ–ª—è 7-8:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Kubernetes (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] **–ù–µ–¥–µ–ª—è 9-10:** Read replicas –¥–ª—è –ë–î
- [ ] **–ù–µ–¥–µ–ª—è 11-12:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Load Testing

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- **Locust** - Python-based load testing
- **k6** - JavaScript-based load testing
- **Apache JMeter** - Java-based

**–°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö)
2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (1000 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω)
3. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (100 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π/–º–∏–Ω)
4. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–æ–≤ (50 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫)

**–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ < 200ms (p95)
- –û—à–∏–±–∫–∏ < 0.1%
- CPU < 70%
- –ü–∞–º—è—Ç—å < 80%

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ 1,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [x] –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] Redis –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- [ ] –ò–Ω–¥–µ–∫—Å—ã –ë–î
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ 10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –í—Å–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
- [ ] –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (2+ –∏–Ω—Å—Ç–∞–Ω—Å–∞)
- [ ] Load Balancer
- [ ] Message Queue
- [ ] –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π rate limiting

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ 100,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –í—Å–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
- [ ] Kubernetes
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus/Grafana)
- [ ] Read replicas
- [ ] CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ 1,000,000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –í—Å–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
- [ ] Sharding –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
- [ ] –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –ü–æ–ª–Ω–∞—è —Ä–µ–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Redis Documentation](https://redis.io/docs/)
- [Kubernetes Documentation](https://kubernetes.io/docs/)
- [Supabase Scaling Guide](https://supabase.com/docs/guides/platform/performance)
- [Nginx Load Balancing](https://nginx.org/en/docs/http/load_balancing.html)

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- [Upstash Redis](https://upstash.com/) - Serverless Redis
- [Fly.io](https://fly.io/) - –•–æ—Å—Ç–∏–Ω–≥ —Å –∞–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥–æ–º
- [Locust](https://locust.io/) - Load testing
- [Prometheus](https://prometheus.io/) - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2 —è–Ω–≤–∞—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏





