# API Documentation - Loyalty Secure API

## üìñ Swagger UI

–í–∞—à API —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é!

### üåê –î–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

**Swagger UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- URL: http://127.0.0.1:8001/docs
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

**ReDoc (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è):**
- URL: http://127.0.0.1:8001/redoc
- –ö—Ä–∞—Å–∏–≤—ã–π —á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**OpenAPI Schema (JSON):**
- URL: http://127.0.0.1:8001/openapi.json
- –°—ã—Ä–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è OpenAPI 3.0

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Swagger UI

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```
http://127.0.0.1:8001/docs
```

### 2. –ü—Ä–æ—Å–º–æ—Ç—Ä endpoints
- Endpoints —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (tags)
- health - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- clients - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- transactions - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–ª–ª–æ–≤
- webhooks - webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
1. –í—ã–±–µ—Ä–∏—Ç–µ endpoint
2. –ù–∞–∂–º–∏—Ç–µ "Try it out"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
4. –ù–∞–∂–º–∏—Ç–µ "Execute"
5. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Health Check
```bash
curl http://127.0.0.1:8001/health
```

–û—Ç–≤–µ—Ç:
```json
{"status": "ok"}
```

### –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç–∞
```bash
curl http://127.0.0.1:8001/clients/123456789/balance
```

–û—Ç–≤–µ—Ç:
```json
{
  "client_chat_id": "123456789",
  "balance": 150
}
```

### –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ)
```bash
curl -X POST http://127.0.0.1:8001/transactions \
  -H "Content-Type: application/json" \
  -d '{
    "client_chat_id": "123456789",
    "partner_chat_id": "987654321",
    "txn_type": "accrual",
    "amount": 1000
  }'
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "new_balance": 200,
  "points": 50
}
```

### –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (—Å–ø–∏—Å–∞–Ω–∏–µ)
```bash
curl -X POST http://127.0.0.1:8001/transactions \
  -H "Content-Type: application/json" \
  -d '{
    "client_chat_id": "123456789",
    "partner_chat_id": "987654321",
    "txn_type": "spend",
    "amount": 50
  }'
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **API Keys** - –¥–æ–±–∞–≤—å—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ API keys
2. **HTTPS** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
3. **Rate Limiting** - –æ–≥—Ä–∞–Ω–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
4. **CORS** - –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ CORS –ø–æ–ª–∏—Ç–∏–∫–∏
5. **IP Whitelist** - –æ–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –ø–æ IP

---

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ API

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ endpoint:

```python
@app.get(
    "/my-endpoint",
    tags=["my-category"],
    summary="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
    description="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ"
)
def my_endpoint():
    \"\"\"
    –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è endpoint.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
    - param1: –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - result: –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    \"\"\"
    return {"result": "success"}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:

```python
from pydantic import BaseModel, Field

class MyModel(BaseModel):
    field1: str = Field(..., description="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª—è")
    field2: int = Field(default=0, description="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª—è")
    
    class Config:
        schema_extra = {
            "example": {
                "field1": "example value",
                "field2": 42
            }
        }
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Sentry Integration
–í—Å–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Sentry:
- https://sentry.io/organizations/YOUR_ORG/

### Telegram Alerts
–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ Telegram —á–µ—Ä–µ–∑ webhook:
- Endpoint: `/api/sentry-webhook`

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞!

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π endpoint
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (–∏–ª–∏ --reload —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É http://127.0.0.1:8001/docs

---

## üåê –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (–¥–ª—è Sentry Webhooks)

–î–ª—è —Ä–∞–±–æ—Ç—ã webhooks –Ω—É–∂–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π URL.

### –í–∞—Ä–∏–∞–Ω—Ç 1: ngrok (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok
brew install ngrok

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—É–Ω–Ω–µ–ª—å
ngrok http 8001

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ URL –≤–∏–¥–∞: https://abc123.ngrok.io
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Deploy –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥
- **Railway**: https://railway.app
- **Render**: https://render.com
- **Fly.io**: https://fly.io
- **Vercel** (–¥–ª—è serverless): https://vercel.com

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [OpenAPI Specification](https://swagger.io/specification/)
- [Pydantic Documentation](https://docs.pydantic.dev/)
- [Sentry Documentation](https://docs.sentry.io/)


