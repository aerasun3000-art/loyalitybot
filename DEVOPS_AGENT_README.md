# ü§ñ DevOps Agent –¥–ª—è LoyalityBot

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ–ø–ª–æ—è–º–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±–æ—Ç–æ–≤.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
chmod +x devops_agent.py

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
./devops_agent.py --help

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –±–æ—Ç–æ–≤
./devops_agent.py status

# –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ
./devops_agent.py info
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### `status` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤ –Ω–∞ Fly.io:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã
./devops_agent.py status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±–æ—Ç
./devops_agent.py status --bot admin
./devops_agent.py status --bot partner
./devops_agent.py status --bot client
```

### `deploy` - –î–µ–ø–ª–æ–π –±–æ—Ç–æ–≤

–î–µ–ø–ª–æ–∏—Ç –±–æ—Ç–æ–≤ –Ω–∞ Fly.io:

```bash
# –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã
./devops_agent.py deploy

# –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±–æ—Ç
./devops_agent.py deploy --bot admin

# –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–±–µ–∑ --remote-only)
./devops_agent.py deploy --no-remote
```

### `logs` - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –ª–æ–≥–∏ –±–æ—Ç–∞:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
./devops_agent.py logs admin

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
./devops_agent.py logs partner --lines 100

# –õ–æ–≥–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –±–æ—Ç–∞
./devops_agent.py logs client
```

### `restart` - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–æ–≤:

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã
./devops_agent.py restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±–æ—Ç
./devops_agent.py restart --bot admin
```

### `health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
./devops_agent.py health
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –±–æ—Ç–æ–≤
- –ù–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ù–∞–ª–∏—á–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –±–æ—Ç–æ–≤
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Fly.io CLI

### `monitor` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º:

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ 5 –º–∏–Ω—É—Ç
./devops_agent.py monitor

# –ö–∞—Å—Ç–æ–º–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
./devops_agent.py monitor --interval 30 --duration 600
```

### `secrets` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ `.env` —Ñ–∞–π–ª–∞:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö –±–æ—Ç–æ–≤
./devops_agent.py secrets

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–æ—Ç–∞
./devops_agent.py secrets --bot admin

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
./devops_agent.py secrets --env .env.production
```

### `info` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ:

```bash
./devops_agent.py info
```

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- Fly.io CLI (`flyctl`) - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Fly.io
  ```bash
  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ macOS
  brew install flyctl
  
  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Linux/Windows
  curl -L https://fly.io/install.sh | sh
  ```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ—Ç–æ–≤

–ê–≥–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–µ–º—è –±–æ—Ç–∞–º–∏:

1. **admin** - –ê–¥–º–∏–Ω-–±–æ—Ç (`loyalitybot-admin`)
   - –ö–æ–Ω—Ñ–∏–≥: `fly.admin.toml`
   - –°–∫—Ä–∏–ø—Ç: `admin_bot.py`

2. **partner** - –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π –±–æ—Ç (`loyalitybot-partner`)
   - –ö–æ–Ω—Ñ–∏–≥: `fly.partner.toml`
   - –°–∫—Ä–∏–ø—Ç: `bot.py`

3. **client** - –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–æ—Ç (`loyalitybot-client`)
   - –ö–æ–Ω—Ñ–∏–≥: `fly.client.toml`
   - –°–∫—Ä–∏–ø—Ç: `client_handler.py`

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –±–æ—Ç–æ–≤
./devops_agent.py status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã
./devops_agent.py health
```

### –î–µ–ø–ª–æ–π –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤—Å–µ –±–æ—Ç—ã
./devops_agent.py deploy

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
./devops_agent.py status
```

### –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
./devops_agent.py status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –±–æ—Ç–∞
./devops_agent.py logs admin --lines 200

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
./devops_agent.py restart --bot admin
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å 10 –º–∏–Ω—É—Ç —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 30 —Å–µ–∫—É–Ω–¥
./devops_agent.py monitor --interval 30 --duration 600
```

## üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

–ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –¥–µ–ø–ª–æ–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã:

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
cat .env

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö –±–æ—Ç–æ–≤
./devops_agent.py secrets
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Fly.io CLI –Ω–µ –Ω–∞–π–¥–µ–Ω

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ flyctl
brew install flyctl  # macOS
# –∏–ª–∏
curl -L https://fly.io/install.sh | sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
flyctl --version
```

### –ë–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ Fly.io

–ï—Å–ª–∏ –±–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
# –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω-–±–æ—Ç–∞
flyctl launch --config fly.admin.toml --app loyalitybot-admin

# –ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã
./devops_agent.py secrets --bot admin

# –ò –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ
./devops_agent.py deploy --bot admin
```

### –û—à–∏–±–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Fly.io:
   ```bash
   flyctl auth whoami
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
   ```bash
   ./devops_agent.py info
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   ./devops_agent.py logs admin
   ```

## üìù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

–ê–≥–µ–Ω—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ GitHub Actions:

```yaml
- name: Check bot status
  run: |
    python3 devops_agent.py status

- name: Deploy bots
  run: |
    python3 devops_agent.py deploy
  env:
    FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }}
```

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∞–ª–∏–∞—Å—ã –≤ `.bashrc` –∏–ª–∏ `.zshrc`:

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ ~/.zshrc –∏–ª–∏ ~/.bashrc
alias bot-status='cd /path/to/loyalitybot && ./devops_agent.py status'
alias bot-deploy='cd /path/to/loyalitybot && ./devops_agent.py deploy'
alias bot-logs='cd /path/to/loyalitybot && ./devops_agent.py logs'
```

## üìä –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ê–≥–µ–Ω—Ç –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–ª—è:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ (Render, Railway)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç—Ä–∏–∫ (CPU, –ø–∞–º—è—Ç—å)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
- –ë—ç–∫–∞–ø–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `./devops_agent.py logs <bot>`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ: `./devops_agent.py health`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `./devops_agent.py status`

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –î–µ–∫–∞–±—Ä—å 2024
