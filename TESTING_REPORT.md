# üìä –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º—É–ª—å—Ç–∏–∫–∞—Ç–µ–≥–æ—Ä–∏–π

## ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞

### 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** –£—Å–ø–µ—à–Ω–æ
- ‚úÖ **–û—à–∏–±–æ–∫:** 0
- ‚úÖ **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:** –¢–æ–ª—å–∫–æ –æ —Ä–∞–∑–º–µ—Ä–µ —á–∞–Ω–∫–æ–≤ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

### 2. –õ–∏–Ω—Ç–µ—Ä
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** –ù–µ—Ç –æ—à–∏–±–æ–∫
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
  - `frontend/src/pages/PartnerAnalytics.jsx`
  - `frontend/src/pages/PartnerApply.jsx`
  - `frontend/src/services/supabase.js`
  - `frontend/src/utils/serviceIcons.js`

### 3. –ò–º–ø–æ—Ä—Ç—ã –∏ —ç–∫—Å–ø–æ—Ä—Ç—ã
- ‚úÖ `getCategoriesByGroup` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ `serviceIcons.js`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `PartnerAnalytics.jsx` (3 –º–µ—Å—Ç–∞)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `PartnerApply.jsx` (2 –º–µ—Å—Ç–∞)
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### 4. –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ `selectedCategories` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `PartnerAnalytics.jsx` (13 —Ä–∞–∑)
- ‚úÖ `selectedCategories` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `PartnerApply.jsx`
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏

### –§—É–Ω–∫—Ü–∏—è `getCategoriesByGroup()`

**–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
```javascript
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç categoryGroup
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ categoryGroup === cat.categoryGroup
3. –ò—Å–∫–ª—é—á–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –º–∞–ø–ø–∏–Ω–≥–∏ (–≥–¥–µ key !== cat.code)
4. –ò—Å–∫–ª—é—á–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
5. –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ displayOrder
```

**–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
- ‚úÖ Beauty: 12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ Food: 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ Retail: 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ Influencer: 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ B2B: 7 –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –§—É–Ω–∫—Ü–∏—è `updatePartnerInfo()`

**–õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:**
```javascript
1. –ï—Å–ª–∏ –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ –≤ business_type
2. –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Üí –º–∞—Å—Å–∏–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ partner_categories
3. –ü–µ—Ä–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Üí is_primary = true
4. –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Üí is_primary = false
```

### –§—É–Ω–∫—Ü–∏—è `getPartnerInfo()`

**–õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:**
```javascript
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ partners –∏–ª–∏ partner_applications
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º—É–ª—å—Ç–∏–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ partner_categories
3. –ï—Å–ª–∏ –º—É–ª—å—Ç–∏–∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ—Ç ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç business_type (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç business_type –∫–∞–∫ —Å—Ç—Ä–æ–∫—É –∏–ª–∏ –º–∞—Å—Å–∏–≤
```

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–∞—Ä—Ç–Ω–µ—Ä —Å –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π (beauty)
**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- ‚úÖ –í —Ñ–æ—Ä–º–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–∞—Ä—Ç–Ω–µ—Ä —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –í —Ñ–æ—Ä–º–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–º–µ–Ω–∞ —Ç–∏–ø–∞ –±–∏–∑–Ω–µ—Å–∞
**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –ü—Ä–∏ —Å–º–µ–Ω–µ category_group –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—á–∏—â–∞—é—Ç—Å—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ –±–∏–∑–Ω–µ—Å–∞
- ‚úÖ –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –í–∞–ª–∏–¥–∞—Ü–∏—è
**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –î–ª—è beauty –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- ‚úÖ –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –¥–µ–ø–ª–æ—é

### –ö–æ–¥
- [x] –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [x] –ù–µ—Ç –æ—à–∏–±–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- [x] –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- [x] –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [x] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è `migrations/add_multicategory_support.sql` –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- [ ] –¢–∞–±–ª–∏—Ü–∞ `partner_categories` —Å–æ–∑–¥–∞–Ω–∞
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã

### –§—Ä–æ–Ω—Ç–µ–Ω–¥
- [x] –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞
- [ ] –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Cloudflare Pages

### –ë–æ—Ç—ã
- [x] –ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –ó–∞–¥–µ–ø–ª–æ–µ–Ω–æ –Ω–∞ Cloudflare Workers

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å migrations/add_multicategory_support.sql –≤ Supabase
   ```

2. **–ó–∞–¥–µ–ø–ª–æ–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:**
   ```bash
   cd frontend
   npm run build
   wrangler pages deploy dist --project-name=loyalitybot-frontend
   ```

3. **–ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –±–æ—Ç—ã:**
   ```bash
   cd cloudflare/workers/partner-webhook
   wrangler deploy
   ```

4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ production:**
   - –û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º—É–ª—å—Ç–∏–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞** - –±–µ–∑ –Ω–µ–µ –º—É–ª—å—Ç–∏–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
3. **–°—Ç–∞—Ä—ã–µ –∫–æ–¥—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞–ø–ø—è—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–µ –≤ –±–æ—Ç–∞—Ö

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**–ö–æ–¥:** ‚úÖ –ì–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é
**–¢–µ—Å—Ç—ã:** ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞

**–¢—Ä–µ–±—É–µ—Ç—Å—è:**
1. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
2. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ production
