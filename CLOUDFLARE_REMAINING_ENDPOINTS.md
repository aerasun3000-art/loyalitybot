# –û—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Cloudflare

**–î–∞—Ç–∞:** 2026-01-18  
**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

1. ‚úÖ `GET /health` - Health check
2. ‚úÖ `GET /clients/:client_chat_id/balance` - –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç–∞
3. ‚úÖ `POST /transactions` - –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (accrual/spend)
4. ‚úÖ `POST /api/redeem-promotion` - –û–±–º–µ–Ω –±–∞–ª–ª–æ–≤ –Ω–∞ –∞–∫—Ü–∏—é

---

## ‚ùå –û—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. **POST /api/translate** - AI –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞

**–í–∞–∂–Ω–æ—Å—Ç—å:** üî¥ **–í–´–°–û–ö–ê–Ø** (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- Frontend: `frontend/src/utils/translate.js`
- –°—Ç—Ä–∞–Ω–∏—Ü—ã: `Home.jsx`, `News.jsx`, `NewsDetail.jsx`, `Promotions.jsx`
- –§—É–Ω–∫—Ü–∏—è: `translateText()`, `translateDynamicContent()`

**–í–ª–∏—è–Ω–∏–µ:**
- ‚ùå **–ë–µ–∑ —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:** –ù–æ–≤–æ—Å—Ç–∏, –∞–∫—Ü–∏–∏ –∏ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –±—É–¥—É—Ç –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å—Å—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≤—ã–±—Ä–∞–≤—à–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫, —É–≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç
- ‚ùå –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI API –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –°–µ–∫—Ä–µ—Ç: `OPENAI_API_KEY`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤: ru, en, es, fr, de, it, pt, zh, ja, ko

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî• **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô** - –Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

---

### 2. **POST /send-qr-to-partner** - –û—Ç–ø—Ä–∞–≤–∫–∞ QR-–∫–æ–¥–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—É

**–í–∞–∂–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø** (–≤–∞–∂–Ω–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –æ–±–º–µ–Ω–∞ –±–∞–ª–ª–æ–≤)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- Backend: `client_handler.py` (—Ñ—É–Ω–∫—Ü–∏—è `send_qr_to_partner()`)
- Frontend: –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–∞ –¥–ª—è –æ–±–º–µ–Ω–∞ –±–∞–ª–ª–æ–≤ –Ω–∞ –∞–∫—Ü–∏—é

**–í–ª–∏—è–Ω–∏–µ:**
- ‚ùå **–ë–µ–∑ —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:** QR-–∫–æ–¥—ã –Ω–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º —á–µ—Ä–µ–∑ Telegram
- ‚ö†Ô∏è –ü–∞—Ä—Ç–Ω–µ—Ä—ã –Ω–µ –ø–æ–ª—É—á–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ QR-–∫–æ–¥–µ –∫–ª–∏–µ–Ω—Ç–∞
- ‚ö†Ô∏è –ö–ª–∏–µ–Ω—Ç–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å QR-–∫–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä—É

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (multipart/form-data)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ Telegram Bot API
- –°–µ–∫—Ä–µ—Ç: `TOKEN_PARTNER`
- –ü–æ–∏—Å–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø–æ `partner_chat_id` –∏–ª–∏ `partner_username`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–°–†–ï–î–ù–ò–ô** - –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π QR-–∫–æ–¥–∞

---

### 3. **POST /api/sentry-webhook** - Webhook –æ—Ç Sentry

**–í–∞–∂–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø** (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- Sentry ‚Üí Cloudflare Worker ‚Üí Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º

**–í–ª–∏—è–Ω–∏–µ:**
- ‚ùå **–ë–µ–∑ —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –Ω–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –∏–∑ Sentry –≤ Telegram
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—à–∏–±–∫–∏ –≤—Ä—É—á–Ω—É—é –≤ Sentry Dashboard
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç Sentry
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –∞–¥–º–∏–Ω–∞–º
- –°–µ–∫—Ä–µ—Ç—ã: `SENTRY_WEBHOOK_SECRET`, `SENTRY_ALERT_TELEGRAM_TOKEN`, `SENTRY_ALERT_CHAT_ID`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ **–ù–ò–ó–ö–ò–ô** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

### 4. **GET /api/district-availability** - –ö–∞—Ä—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–∞–π–æ–Ω–æ–≤

**–í–∞–∂–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø** (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- –í–æ–∑–º–æ–∂–Ω–æ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏–ª–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ (—Ä–∞–π–æ–Ω √ó —É—Å–ª—É–≥–∞) –∑–∞–Ω—è—Ç—ã/–¥–æ—Å—Ç—É–ø–Ω—ã

**–í–ª–∏—è–Ω–∏–µ:**
- ‚ùå **–ë–µ–∑ —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:** –ù–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, –∫–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–Ω—è—Ç—ã –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏
- ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Ç–æ –≤–∞–∂–Ω–æ

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ó–∞–ø—Ä–æ—Å –∫ Supabase –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–Ω—è—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä: `city` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "New York")

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° **–°–†–ï–î–ù–ò–ô** - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è

---

### 5. **GET /api/services/:service_id** - –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å–ª—É–≥–∏

**–í–∞–∂–Ω–æ—Å—Ç—å:** ‚ùì **–ù–ï–ò–ó–í–ï–°–¢–ù–û** (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ frontend

**–í–ª–∏—è–Ω–∏–µ:**
- ‚ùì –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** ‚ùì **–ü–†–û–í–ï–†–ò–¢–¨** - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Ç–æ –¥–æ–±–∞–≤–∏—Ç—å

---

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –í–∞–∂–Ω–æ—Å—Ç—å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–∞–±–æ—Ç—É |
|----------|----------|-----------|-------------------|
| `POST /api/translate` | üî¥ –í–´–°–û–ö–ê–Ø | üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô | –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| `POST /send-qr-to-partner` | üü° –°–†–ï–î–ù–Ø–Ø | üü° –°–†–ï–î–ù–ò–ô | QR-–∫–æ–¥—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| `POST /api/sentry-webhook` | üü¢ –ù–ò–ó–ö–ê–Ø | üü¢ –ù–ò–ó–ö–ò–ô | –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö |
| `GET /api/district-availability` | üü° –°–†–ï–î–ù–Ø–Ø | üü° –°–†–ï–î–ù–ò–ô | –ù–µ—Ç –∫–∞—Ä—Ç—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–π |
| `GET /api/services/:service_id` | ‚ùì –ù–ï–ò–ó–í–ï–°–¢–ù–û | ‚ùì –ü–†–û–í–ï–†–ò–¢–¨ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –°—Ä–æ—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:
1. **POST /api/translate** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ:
2. **POST /send-qr-to-partner** - —É–ª—É—á—à–∞–µ—Ç UX, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
3. **GET /api/district-availability** - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ
4. **POST /api/sentry-webhook** - –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
5. **GET /api/services/:service_id** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≤ frontend

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –±–∞–ª–∞–Ω—Å, –æ–±–º–µ–Ω –±–∞–ª–ª–æ–≤) —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü–µ—Ä–µ–≤–æ–¥—ã - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫—Ä–∏—Ç–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
