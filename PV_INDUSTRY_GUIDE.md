# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ PV (Partner Value) –ø–æ –æ—Ç—Ä–∞—Å–ª—è–º

**–î–∞—Ç–∞:** –ù–æ—è–±—Ä—å 2025  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üéØ –ß—Ç–æ —Ç–∞–∫–æ–µ PV?

**PV (Partner Value)** - —ç—Ç–æ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –¥–æ—Ö–æ–¥–æ–≤ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–ø–∞–Ω–∏—è.

PV –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç:
- –û—Ç—Ä–∞—Å–ª–∏ –±–∏–∑–Ω–µ—Å–∞
- –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —É—Å–ª—É–≥
- –¢–∏–ø–∞ –±–∏–∑–Ω–µ—Å–∞
- –î–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ PV –ø–æ –æ—Ç—Ä–∞—Å–ª—è–º

### –ö–∞—Ñ–µ –∏ –†–µ—Å—Ç–æ—Ä–∞–Ω—ã
```
PV: 5-7%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –ù–∏–∑–∫–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –≤—ã—Å–æ–∫–∏–π –æ–±–æ—Ä–æ—Ç
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –ö–∞—Ñ–µ: 5%
‚îú‚îÄ –†–µ—Å—Ç–æ—Ä–∞–Ω—ã: 6%
‚îî‚îÄ –§–∞—Å—Ç—Ñ—É–¥: 7%
```

### –°–∞–ª–æ–Ω—ã –∫—Ä–∞—Å–æ—Ç—ã –∏ –ë–∞—Ä–±–µ—Ä—à–æ–ø—ã
```
PV: 8-10%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ: 8%
‚îú‚îÄ –°–∞–ª–æ–Ω—ã –∫—Ä–∞—Å–æ—Ç—ã: 9%
‚îî‚îÄ –ü—Ä–µ–º–∏—É–º —Å–∞–ª–æ–Ω—ã: 10%
```

### –§–∏—Ç–Ω–µ—Å-–∫–ª—É–±—ã –∏ –°—Ç—É–¥–∏–∏
```
PV: 6-8%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –ê–±–æ–Ω–µ–º–µ–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å, —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –§–∏—Ç–Ω–µ—Å-–∫–ª—É–±—ã: 6%
‚îú‚îÄ –ô–æ–≥–∞-—Å—Ç—É–¥–∏–∏: 7%
‚îî‚îÄ –¢—Ä–µ–Ω–∞–∂–µ—Ä–Ω—ã–µ –∑–∞–ª—ã: 8%
```

### –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ü–µ–Ω—Ç—Ä—ã
```
PV: 10-12%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –í—ã—Å–æ–∫–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è: 10%
‚îú‚îÄ –°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è: 11%
‚îî‚îÄ –ü–ª–∞—Å—Ç–∏—á–µ—Å–∫–∞—è —Ö–∏—Ä—É—Ä–≥–∏—è: 12%
```

### –ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å—ã
```
PV: 7-9%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –ê–≤—Ç–æ–º–æ–π–∫–∏: 7%
‚îú‚îÄ –°–¢–û: 8%
‚îî‚îÄ –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂: 9%
```

### –ú–∞–≥–∞–∑–∏–Ω—ã –∏ –ë—É—Ç–∏–∫–∏
```
PV: 4-6%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –ù–∏–∑–∫–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ–≤–∞—Ä–Ω—ã–π –æ–±–æ—Ä–æ—Ç
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –û–¥–µ–∂–¥–∞: 4%
‚îú‚îÄ –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã: 5%
‚îî‚îÄ –ü—Ä–µ–º–∏—É–º –±—É—Ç–∏–∫–∏: 6%
```

### –¢–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å—Ç—É–¥–∏–∏
```
PV: 8-10%
–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ: –í—ã—Å–æ–∫–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏
–ü—Ä–∏–º–µ—Ä—ã:
‚îú‚îÄ –§–æ—Ç–æ—Å—Ç—É–¥–∏–∏: 8%
‚îú‚îÄ –¢–∞—Ç—É-—Å–∞–ª–æ–Ω—ã: 9%
‚îî‚îÄ –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—É–¥–∏–∏: 10%
```

---

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PV

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞

```python
from partner_revenue_share import PartnerRevenueShare
from supabase_manager import SupabaseManager

db = SupabaseManager()
revenue_share = PartnerRevenueShare(db)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã
revenue_share.set_partner_pv(
    partner_chat_id="123456789",
    pv_percent=9.0,  # 9% –¥–ª—è —Å–∞–ª–æ–Ω–∞
    industry_type="salon"
)
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –≤—Å–µ–π –æ—Ç—Ä–∞—Å–ª–∏

```python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ñ–µ
revenue_share.set_industry_pv(
    industry_type="cafe",
    pv_percent=5.0
)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –≤—Å–µ—Ö —Å–∞–ª–æ–Ω–æ–≤
revenue_share.set_industry_pv(
    industry_type="salon",
    pv_percent=9.0
)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ PV –ø–∞—Ä—Ç–Ω–µ—Ä–∞

```python
# –ü–æ–ª—É—á–∏—Ç—å PV –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
pv = revenue_share.get_partner_pv("123456789")
print(f"PV –ø–∞—Ä—Ç–Ω–µ—Ä–∞: {pv}%")
```

### –ß–µ—Ä–µ–∑ SQL

```sql
-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞
UPDATE partners
SET pv_percent = 9.0, industry_type = 'salon'
WHERE chat_id = '123456789';

-- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PV –¥–ª—è –≤—Å–µ–π –æ—Ç—Ä–∞—Å–ª–∏
UPDATE partners
SET pv_percent = 5.0
WHERE industry_type = 'cafe';

-- –ü—Ä–æ—Å–º–æ—Ç—Ä PV –≤—Å–µ—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
SELECT chat_id, name, company_name, industry_type, pv_percent
FROM partners
WHERE partner_type != 'regular'
ORDER BY industry_type, pv_percent;
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ —Å PV

### –ü—Ä–∏–º–µ—Ä 1: –ö–∞—Ñ–µ (PV = 5%)

```
–ü–∞—Ä—Ç–Ω–µ—Ä (–∫–∞—Ñ–µ):
‚îú‚îÄ –û–±–æ—Ä–æ—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–≤: $20,000/–º–µ—Å
‚îú‚îÄ PV: 5%
‚îú‚îÄ –î–æ—Ö–æ–¥ —Å–∏—Å—Ç–µ–º—ã: $20,000 √ó 5% = $1,000/–º–µ—Å
‚îî‚îÄ Revenue Share (5%): $1,000 √ó 5% = $50/–º–µ—Å (–¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –≤—ã—à–µ)
```

### –ü—Ä–∏–º–µ—Ä 2: –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã (PV = 9%)

```
–ü–∞—Ä—Ç–Ω–µ—Ä (—Å–∞–ª–æ–Ω):
‚îú‚îÄ –û–±–æ—Ä–æ—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–≤: $20,000/–º–µ—Å
‚îú‚îÄ PV: 9%
‚îú‚îÄ –î–æ—Ö–æ–¥ —Å–∏—Å—Ç–µ–º—ã: $20,000 √ó 9% = $1,800/–º–µ—Å
‚îî‚îÄ Revenue Share (5%): $1,800 √ó 5% = $90/–º–µ—Å (–¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –≤—ã—à–µ)
```

### –ü—Ä–∏–º–µ—Ä 3: –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä (PV = 11%)

```
–ü–∞—Ä—Ç–Ω–µ—Ä (–º–µ–¥—Ü–µ–Ω—Ç—Ä):
‚îú‚îÄ –û–±–æ—Ä–æ—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–≤: $20,000/–º–µ—Å
‚îú‚îÄ PV: 11%
‚îú‚îÄ –î–æ—Ö–æ–¥ —Å–∏—Å—Ç–µ–º—ã: $20,000 √ó 11% = $2,200/–º–µ—Å
‚îî‚îÄ Revenue Share (5%): $2,200 √ó 5% = $110/–º–µ—Å (–¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –≤—ã—à–µ)
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PV

### –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–∏

```python
# –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç—Ä–∞—Å–ª—å
partner_data = {
    'chat_id': '123456789',
    'name': '–°–∞–ª–æ–Ω "–ö—Ä–∞—Å–æ—Ç–∞"',
    'company_name': '–û–û–û –ö—Ä–∞—Å–æ—Ç–∞',
    'industry_type': 'salon',  # –£–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç—Ä–∞—Å–ª—å
    'pv_percent': 9.0  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PV
}
```

### –®–∞–≥ 2: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PV

```python
# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç PV –≤—Ä—É—á–Ω—É—é
revenue_share.set_partner_pv(
    partner_chat_id="123456789",
    pv_percent=9.0,  # –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
    industry_type="salon"
)
```

### –®–∞–≥ 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–∞ —Å–∏—Å—Ç–µ–º—ã

```python
# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PV –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ
system_revenue = revenue_share._get_system_revenue(
    partner_chat_id="123456789",
    period_start=date(2025, 11, 1),
    period_end=date(2025, 11, 30)
)
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PV –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PV

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö PV

```sql
SELECT 
    chat_id,
    name,
    company_name,
    industry_type,
    pv_percent,
    CASE 
        WHEN pv_percent < 5 THEN '–ù–∏–∑–∫–∏–π'
        WHEN pv_percent < 8 THEN '–°—Ä–µ–¥–Ω–∏–π'
        ELSE '–í—ã—Å–æ–∫–∏–π'
    END as pv_category
FROM partners
WHERE partner_type != 'regular'
ORDER BY industry_type, pv_percent;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç—Ä–∞—Å–ª—è–º

```sql
SELECT 
    industry_type,
    COUNT(*) as partners_count,
    AVG(pv_percent) as avg_pv,
    MIN(pv_percent) as min_pv,
    MAX(pv_percent) as max_pv
FROM partners
WHERE industry_type IS NOT NULL
GROUP BY industry_type
ORDER BY avg_pv DESC;
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **PV –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
2. **PV –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º** –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –æ–¥–Ω–æ–π –æ—Ç—Ä–∞—Å–ª–∏
3. **PV –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ—Ö–æ–¥ —Å–∏—Å—Ç–µ–º—ã** –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ Revenue Share
4. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å PV** —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª
5. **PV –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º** –¥–ª—è –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PV

- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Ç—Ä–∞—Å–ª—å –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PV –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Ç—Ä–∞—Å–ª–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç –¥–æ—Ö–æ–¥–∞ —Å–∏—Å—Ç–µ–º—ã
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ PV —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å PV –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PV

---

**–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** –ù–æ—è–±—Ä—å 2025  
**–í–µ—Ä—Å–∏—è:** 1.0






